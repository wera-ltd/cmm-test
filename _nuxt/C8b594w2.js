import S from"./CulxzA0G.js";import{g as K,p as C,r as m,x as w,c as _,o as V,b as O,y as z,s as L,M as j,w as k,d as T,a as y,t as $,k as u,B as F,A as P}from"./DLbfEYiI.js";const U={class:"relative"},q={class:"absolute top-0 w-full z-10"},G=["src"],Q=K({__name:"TreeMultiSelect",props:{options:{},modelValue:{},placeholder:{default:"판매채널 선택"},buttonClass:{default:""}},emits:["update:modelValue"],setup(D,{emit:M}){const a=D,B=M,v=C(()=>[{label:"전체",key:"all",children:a.options}]),f=l=>{const n={},c=l.map(t=>t.key),d=t=>{t.forEach(e=>{if(e.children&&e.children.length>0){d(e.children);const r=s(e.children),o=r.filter(b=>c.includes(b.key)).length;o===r.length&&r.length>0?n[e.key]={checked:!0,partialChecked:!1}:o>0?n[e.key]={checked:!1,partialChecked:!0}:n[e.key]={checked:!1,partialChecked:!1}}else n[e.key]={checked:c.includes(e.key),partialChecked:!1}})},s=t=>{const e=[];return t.forEach(r=>{r.children&&r.children.length>0?e.push(...s(r.children)):e.push(r)}),e};return d(v.value),n},i=m({all:!0}),h=m(f(a.modelValue));w(()=>a.modelValue,l=>{h.value=f(l)}),w(()=>a.options,l=>{h.value=f(a.modelValue)});const p=m(!1),N=()=>{p.value=!1},A=l=>{if(l.value!==""){for(const n of a.options)g(n);i.value={...i.value}}else i.value={all:!0}},g=l=>{if(l.children&&l.children.length){i.value[l.key]=!0;for(const n of l.children)g(n)}},x=l=>{const n=Object.entries(l).filter(([s,t])=>t.checked===!0).map(([s])=>s),c=s=>{const t=[];return s.forEach(e=>{e.children&&e.children.length>0?t.push(...c(e.children)):t.push(e)}),t};return c(a.options).filter(s=>n.includes(s.key))},E=C(()=>{const l=new Map,n=new Map,c=(t,e,r=1)=>{for(const o of e){if(o.key===t)return{parent:null,depth:r};if(o.children&&o.children.length>0&&d(t,o.children))return{parent:o,depth:r+1}}return{parent:null,depth:1}},d=(t,e)=>{for(const r of e)if(r.key===t||r.children&&r.children.length>0&&d(t,r.children))return!0;return!1};x(h.value).forEach(t=>{const{parent:e,depth:r}=c(t.key,a.options);if(e){const o=l.get(e.label)||0;l.set(e.label,o+1),n.set(e.label,r)}else{const o=l.get(t.label)||0;l.set(t.label,o+1),n.set(t.label,1)}});const s=Array.from(l.entries()).map(([t,e])=>n.get(t)===1?t:`${t}(${e}개)`);if(s.length>1)return`${s[0]} 외 ${s.length-1}개`;if(s.length===1){const[t,e]=Array.from(l.entries())[0];return n.get(t)===1?t:`${t}(${e}개)`}else return""});return(l,n)=>{const c=L,d=S;return V(),_("div",U,[O(c,{outlined:"",class:j(["w-full justify-between! bg-white! border-[#d1d5db]! text-gray-500! rounded-md text-sm!",a.buttonClass]),onClick:n[0]||(n[0]=s=>p.value=!0)},{default:k(()=>[T($(u(E)||l.placeholder)+" ",1),n[2]||(n[2]=y("i",{class:"pi pi-chevron-down ml-2 flex-none text-sm!"},null,-1))]),_:1,__:[2]},8,["class"]),z(y("div",q,[O(d,{filter:!0,"filter-mode":"lenient","selection-keys":u(h),value:u(v),"expanded-keys":u(i),"selection-mode":"checkbox",class:"w-full relative z-10 px-0! py-0! shadow-md","filter-placeholder":l.placeholder,pt:{pcfilterinput:{root:"h-[38px]"},wrapper:"pb-2 text-sm! max-h-[50vh]",pcNodeCheckbox:{root:"w-4! h-4! mr-1",box:"h-full!"},nodeToggleButton:"w-4! h-4!"},"onUpdate:selectionKeys":n[1]||(n[1]=s=>B("update:modelValue",x(s))),onFilter:A},{nodeicon:k(s=>[s.node.icon?(V(),_("img",{key:0,src:s.node.icon,class:"w-5 h-5",alt:""},null,8,G)):P("",!0)]),default:k(s=>[T($(s.node.label),1)]),_:1},8,["selection-keys","value","expanded-keys","filter-placeholder"]),y("div",{class:"fixed inset-0",onClick:N})],512),[[F,u(p)]])])}}});export{Q as _};
