import{_ as Z}from"./B-uPDQ9X.js";import{_ as ee}from"./CU3_xFeX.js";import{_ as te}from"./C9nYTXdO.js";import{T as oe}from"./Dr8NtIdw.js";import re from"./-V4C2hKS.js";import se from"./u6RkTaH5.js";import ne from"./D5dSWHQX.js";import le from"./BNK-WaIJ.js";import ce from"./Bjj4vEVV.js";import ae from"./IEBI1WC9.js";import{m as ie,n as de,r as D,p as V,x as ue,g as pe,v as me,j as _e,c as m,o as a,b as v,a as e,w as g,s as he,k as t,F as z,L as B,z as P,A as k,l as fe,t as _,M as N,y as xe,d as A,C as ve,P as T}from"./D0irmNLU.js";import{u as j}from"./CISQY5Kl.js";import{u as ye}from"./anOkeMCG.js";import{u as ge}from"./BVcOksx9.js";import"./C6bphXqf.js";import"./sX_moKle.js";import"./CH_ntNRm.js";import"./DfIelFuD.js";import"./CY8PUfZe.js";import"./Dy2AIn-S.js";import"./DfUxl_D0.js";import"./gzj-HYwW.js";import"./DWfrF6LL.js";import"./DBaWVl5m.js";import"./CHP5rB4B.js";import"./Bb_8cgyb.js";import"./BpT3c-yQ.js";import"./NxVLiVMO.js";import"./C9lanvF1.js";import"./BxHRICLi.js";const be=ie(()=>{const{data:b,...w}=de({key:()=>["workHistory","errorList"],query:()=>j().workHistory.historyErrorListGet().then(o=>o.data)}),h=D({keyword:"",errorCategory:"All"}),E=V(()=>{var l;const o=[{name:"All",code:"All"},{name:"옵션변경",code:"error-001"},{name:"판매중지",code:"error-002"},{name:"상품조회",code:"error-003"},{name:"채널정책",code:"error-999"}],i=((l=b.value)==null?void 0:l.error_group_code_data)||[];return o.map(d=>{var x;if(d.code==="All")return{...d,count:((x=b.value)==null?void 0:x.error_tot_count)||0};const u=i.find(y=>y.code===d.code);return{...d,count:(u==null?void 0:u.count)||0}})}),f=V(()=>{var i;let o=((i=b.value)==null?void 0:i.error_data_list)||[];if(h.value.errorCategory!=="All"&&(o=o.filter(l=>l.error_type_code===h.value.errorCategory)),h.value.keyword&&h.value.keyword.trim()){const l=h.value.keyword.trim();o=o.filter(d=>{const u=(d.channel_product_name||"").toLowerCase(),x=(d.channel_product_id||"").toLowerCase(),y=(d.error_type_name||"").toLowerCase(),p=(d.channel_name||"").toLowerCase();return u.includes(l)||x.includes(l)||y.includes(l)||p.includes(l)})}return o}),n=D([]),I=V({get:()=>f.value.length?n.value.length===f.value.length:!1,set:o=>{o?n.value=[...f.value]:n.value=[]}}),L=o=>n.value.some(i=>i._id===o._id),C=o=>{const i=n.value.findIndex(l=>l._id===o._id);i>-1?n.value.splice(i,1):n.value.push(o)};return ue(f,()=>{n.value=[]}),{data:b,errorCategories:E,filteredErrorData:f,filter:h,isAllSelected:I,isItemSelected:L,selectedItems:n,toggleItemSelection:C,...w}}),ke={class:"portrait:h-dvh"},we={class:"flex items-center gap-1"},Ce={ref:"$elExceptDiv",class:"px-4 js-exception-content"},Se={class:"flex items-center mb-1 bg-white rounded-2xl"},$e=["onClick"],Pe={class:"text-sm font-normal"},Ee={key:1,class:"text-sm font-normal"},Ie={class:"flex items-center"},Le={class:"flex items-center gap-2 text-sm"},Ve={key:0,class:"font-medium"},Ae={class:"js-list"},He={class:"flex w-full items-center mb-1"},De={class:"w-4"},ze={class:"p-checkbox p-component p-checkbox-sm p-inputfield-sm group has-checked:checked has-checked:text-white"},Be=["checked","onChange"],Ne={class:"p-checkbox-box text-center peer-checked:border-[var(--p-checkbox-checked-border-color)]! peer-checked:bg-[var(--p-checkbox-checked-background)]! peer-checked:background group cursor-pointer"},Te={key:0,class:"pi pi-check w-[var(--p-checkbox-icon-size)] text-xs! h-[var(--p-checkbox-icon-size)] text-[var(--p-checkbox-icon-checked-color)]!"},je={class:"w-14 text-center flex-none"},Me=["src"],qe={class:"gap-1 w-[calc(100%-7rem)] ml-1"},Qe={class:"flex items-center justify-between mb-1"},Re={class:"font-medium leading-4"},Ue={class:"flex items-center"},Fe={class:"text-gray-400 text-xxs overflow-ellipsis whitespace-nowrap overflow-hidden"},Oe={type:"button",class:"text-xs w-8 h-8 right-0 top-0 text-[#3f7ddc]"},Ge={class:"flex items-center pl-4"},Je={class:"w-14 text-center flex-none text-xs text-gray-400"},Ke={class:"w-[calc(100%-4rem)] text-xs ml-1 flex items-center justify-between pr-3"},We={class:"text-red-400"},Et=pe({__name:"error-list",setup(b){const w=j(),{contentHeight:h,updateAllHeights:E}=ye(".js-exception-content");me(()=>{E()});const{confirm:f,toast:n}=_e(),{getChannelIcon:I}=ge(),{data:L,error:C,isLoading:o,refetch:i,errorCategories:l,filteredErrorData:d,filter:u,isAllSelected:x,isItemSelected:y,selectedItems:p,toggleItemSelection:M}=be(),q=()=>{if(p.value.length===0){n.error("최소 1개이상의 품목을 선택바랍니다.");return}f({header:"오류 재전송",message:"채널로 오류 상품을 재전송하시겠습니까?",accept:()=>{console.log("확인");const{mutate:S}=T({mutation:()=>w.workHistory.historyErrorSyncPost({HistoryErrorSyncPostRequest:{type:"T",mid:p.value.map(r=>r.mid)}}),onSuccess:()=>{n.success(`총 ${p.value.length}건이 전송되었습니다.`)}});S()}})},Q=()=>{if(p.value.length===0){n.error("최소 1개이상의 품목을 선택바랍니다.");return}f({header:"상품 동기화",message:"옵션을 동기화 하시겠습니까?",accept:()=>{console.log("확인");const{mutate:S}=T({mutation:()=>w.workHistory.historyErrorSyncPost({HistoryErrorSyncPostRequest:{type:"S",mid:p.value.map(r=>r.mid)}}),onSuccess:()=>{n.success(`총 ${p.value.length}건이 상품 동기화 진행합니다.`)}});S()}})};return(S,r)=>{const H=he,R=Z,U=ae,F=ce,O=le,G=ne,J=ee,K=te,W=se,X=re,Y=oe;return a(),m("article",ke,[v(R,null,{right:g(()=>[e("div",we,[v(H,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-white! border-white!",rounded:"",outlined:"",onClick:q},{default:g(()=>r[2]||(r[2]=[e("span",{class:"text-sm"},"오류 재전송",-1)])),_:1,__:[2]}),v(H,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-blue-100! border-blue-100!",rounded:"",onClick:Q},{default:g(()=>r[3]||(r[3]=[e("span",{class:"text-sm"},"상품 동기화",-1)])),_:1,__:[3]})])]),_:1}),e("div",Ce,[v(O,{class:"mb-4 w-full"},{default:g(()=>[v(U,{modelValue:t(u).keyword,"onUpdate:modelValue":r[0]||(r[0]=c=>t(u).keyword=c),type:"text",class:"text-sm! w-full rounded-full! peer",placeholder:"상품명, 품목코드, 오류구분을 입력하세요"},null,8,["modelValue"]),v(F,{class:"pi pi-search peer-focus:text-primary!"})]),_:1}),e("div",Se,[(a(!0),m(z,null,B(t(l),(c,s)=>(a(),m("button",{key:s,class:N(["py-2 w-full text-center text-gray-600",{"rounded-l-2xl w-56!":s===0,"rounded-r-2xl":s===t(l).length-1,"bg-gray-950 text-white":t(u).errorCategory===c.code}]),onClick:$=>t(u).errorCategory=c.code},[c.count?(a(),P(G,{key:0,value:c.count,size:"small",pt:{pcBadge:{root:"font-normal! bg-red-400! outline-1! rounded-full! -top-[5px]! right-[5px]!"}}},{default:g(()=>[e("strong",Pe,_(c.name),1)]),_:2},1032,["value"])):(a(),m("strong",Ee,_(c.name),1))],10,$e))),128))])],512),e("div",{class:"px-4 pt-2 overflow-auto scrollbar-none transition-all duration-300",style:ve({height:t(h)})},[t(o)?(a(),P(J,{key:0,class:"h-full"})):k("",!0),t(C)?(a(),P(K,{key:1,retry:t(i)},null,8,["retry"])):k("",!0),e("div",Ie,[e("div",Le,[v(W,{modelValue:t(x),"onUpdate:modelValue":r[1]||(r[1]=c=>fe(x)?x.value=c:null),size:"small","input-id":"all",name:"all",binary:!0},null,8,["modelValue"]),r[4]||(r[4]=e("label",{for:"all"},"전체선택",-1)),t(p).length>0?(a(),m("p",Ve,_(t(p).length)+"개 선택 ",1)):k("",!0)])]),!t(o)&&!t(C)&&t(L)?(a(),P(X,{key:2,value:t(d),class:"w-full h-full",pt:{content:"bg-inherit! h-full"}},{list:g(c=>[e("div",Ae,[(a(!0),m(z,null,B(c.items,(s,$)=>(a(),m("div",{key:$},[e("div",{class:N(["w-full py-2 text-sm border-gray-300 dark:border-gray-700",{"border-t":$!==0,"border-b":$===c.items.length-1}])},[e("div",He,[e("div",De,[e("div",ze,[e("input",{type:"checkbox",class:"w-4 h-4 border peer appearance-none border-transparent rounded-[var(--p-checkbox-border-radius)] active:border-[var(--p-checkbox-hover-border-color)] absolute top-0 left-0 cursor-pointer",checked:t(y)(s),onChange:Xe=>t(M)(s)},null,40,Be),e("div",Ne,[t(y)(s)?(a(),m("i",Te)):k("",!0)])])]),e("div",je,[e("img",{src:t(I)(s.channel_id),alt:"",class:"w-10 h-10 mx-auto"},null,8,Me)]),e("div",qe,[e("div",Qe,[e("p",Re,_(s.channel_product_name),1)]),e("div",Ue,[e("div",Fe,[A(_(s.channel_name)+" ",1),r[5]||(r[5]=e("span",{class:"bg-gray-300 mx-1 w-px h-2 inline-block"},null,-1)),A(" "+_(s.channel_product_id),1)])])]),xe((a(),m("button",Oe,r[6]||(r[6]=[e("i",{class:"pi pi-chevron-down text-gray-400! text-sm!"},null,-1)]))),[[Y,{value:s.msg,pt:{text:"text-sm!"}},void 0,{focus:!0,bottom:!0}]])]),e("div",Ge,[e("div",Je,_(s.worker_name),1),e("div",Ke,[e("span",We,_(s.error_type_name),1),A(" "+_(s.created_at),1)])])],2)]))),128))])]),_:1},8,["value"])):k("",!0)],4)])}}});export{Et as default};
