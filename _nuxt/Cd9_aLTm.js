import B from"./BomSBUmz.js";import{g as E,r as p,z as S,G as A,c as C,o as b,b as _,A as $,s as z,w as m,d as T,a as y,t as O,k as u,C as F,m as L,T as P}from"./H8knmy_J.js";const G={class:"relative"},U={class:"absolute top-0 w-full"},q=["src"],Q=E({__name:"TreeMultiSelect",props:{options:{},modelValue:{},placeholder:{default:"판매채널 선택"}},emits:["update:modelValue"],setup(V,{emit:D}){const d=V,K=D,k=[{label:"전체",key:"all",children:d.options}],v=n=>{const l={},c=n.map(t=>t.key),a=t=>{t.forEach(e=>{if(e.children&&e.children.length>0){a(e.children);const s=r(e.children),o=s.filter(x=>c.includes(x.key)).length;o===s.length&&s.length>0?l[e.key]={checked:!0,partialChecked:!1}:o>0?l[e.key]={checked:!1,partialChecked:!0}:l[e.key]={checked:!1,partialChecked:!1}}else l[e.key]={checked:c.includes(e.key),partialChecked:!1}})},r=t=>{const e=[];return t.forEach(s=>{s.children&&s.children.length>0?e.push(...r(s.children)):e.push(s)}),e};return a(k),l},i=p({all:!0}),h=p(v(d.modelValue));S(()=>d.modelValue,n=>{h.value=v(n)});const f=p(!1),M=()=>{f.value=!1},N=n=>{if(n.value!==""){for(let l of d.options)g(l);i.value={...i.value}}else i.value={all:!0}},g=n=>{if(n.children&&n.children.length){i.value[n.key]=!0;for(let l of n.children)g(l)}},w=n=>{const l=Object.entries(n).filter(([r,t])=>t.checked===!0).map(([r])=>r),c=r=>{const t=[];return r.forEach(e=>{e.children&&e.children.length>0?t.push(...c(e.children)):t.push(e)}),t};return c(d.options).filter(r=>l.includes(r.key))},j=A(()=>{const n=new Map,l=new Map,c=(t,e,s=1)=>{for(const o of e){if(o.key===t)return{parent:null,depth:s};if(o.children&&o.children.length>0&&a(t,o.children))return{parent:o,depth:s+1}}return{parent:null,depth:1}},a=(t,e)=>{for(const s of e)if(s.key===t||s.children&&s.children.length>0&&a(t,s.children))return!0;return!1};return w(h.value).forEach(t=>{const{parent:e,depth:s}=c(t.key,d.options);if(e){const o=n.get(e.label)||0;n.set(e.label,o+1),l.set(e.label,s)}else{const o=n.get(t.label)||0;n.set(t.label,o+1),l.set(t.label,1)}}),Array.from(n.entries()).map(([t,e])=>l.get(t)===1?t:`${t}(${e}개)`).join(", ")});return(n,l)=>{const c=z,a=B;return b(),C("div",G,[_(c,{outlined:"",class:"w-full justify-between! bg-white! border-[#d1d5db]! text-gray-500! rounded-md! text-sm!",onClick:l[0]||(l[0]=r=>f.value=!0)},{default:m(()=>[T(O(u(j)||n.placeholder)+" ",1),l[2]||(l[2]=y("i",{class:"pi pi-chevron-down ml-2 flex-none text-sm!"},null,-1))]),_:1,__:[2]}),$(y("div",U,[_(a,{filter:!0,filterMode:"lenient",selectionKeys:u(h),"onUpdate:selectionKeys":l[1]||(l[1]=r=>K("update:modelValue",w(r))),value:k,expandedKeys:u(i),selectionMode:"checkbox",class:"w-full md:w-[30rem] relative z-10 px-0! py-0! shadow-md",onFilter:N,pt:{wrapper:"pb-2 text-sm!",pcNodeCheckbox:{root:"w-4! h-4! mr-1",box:"h-full!"},nodeToggleButton:"w-4! h-4!"}},{nodeicon:m(r=>[r.node.icon?(b(),C("img",{key:0,src:r.node.icon,class:"w-5 h-5"},null,8,q)):L("",!0)]),default:m(r=>[T(O(r.node.label),1)]),_:1},8,["selectionKeys","expandedKeys"]),y("div",{class:"fixed inset-0",onClick:M})],512),[[F,u(f)]])])}}});function R(){return P}export{Q as _,R as u};
