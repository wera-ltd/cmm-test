import K from"./Dum_ylUk.js";import{g as $,p as b,r as m,x as w,c as _,o as T,b as V,y as j,s as z,M as F,w as k,d as O,a as y,t as D,k as u,B as L,A as P}from"./BEa_PHPR.js";const U={class:"relative"},q={class:"absolute top-0 w-full z-10"},G=["src"],Q=$({__name:"TreeMultiSelect",props:{options:{},modelValue:{},placeholder:{default:"판매채널 선택"},buttonClass:{default:""}},emits:["update:modelValue"],setup(M,{emit:B}){const a=M,N=B,v=b(()=>[{label:"전체",key:"all",children:a.options}]),p=l=>{const s={},c=l.map(t=>t.key),d=t=>{t.forEach(e=>{if(e.children&&e.children.length>0){d(e.children);const n=o(e.children),r=n.filter(C=>c.includes(C.key)).length;r===n.length&&n.length>0?s[e.key]={checked:!0,partialChecked:!1}:r>0?s[e.key]={checked:!1,partialChecked:!0}:s[e.key]={checked:!1,partialChecked:!1}}else s[e.key]={checked:c.includes(e.key),partialChecked:!1}})},o=t=>{const e=[];return t.forEach(n=>{n.children&&n.children.length>0?e.push(...o(n.children)):e.push(n)}),e};return d(v.value),s},i=m({all:!0}),h=m(p(a.modelValue));w(()=>a.modelValue,l=>{h.value=p(l)}),w(()=>a.options,l=>{h.value=p(a.modelValue)});const f=m(!1),E=()=>{f.value=!1},S=l=>{if(l.value!==""){for(const s of a.options)x(s);i.value={...i.value}}else i.value={all:!0}},x=l=>{if(l.children&&l.children.length){i.value[l.key]=!0;for(const s of l.children)x(s)}},g=l=>{const s=Object.entries(l).filter(([o,t])=>t.checked===!0).map(([o])=>o),c=o=>{const t=[];return o.forEach(e=>{e.children&&e.children.length>0?t.push(...c(e.children)):t.push(e)}),t};return c(a.options).filter(o=>s.includes(o.key))},A=b(()=>{const l=new Map,s=new Map,c=(t,e,n=1)=>{for(const r of e){if(r.key===t)return{parent:null,depth:n};if(r.children&&r.children.length>0&&d(t,r.children))return{parent:r,depth:n+1}}return{parent:null,depth:1}},d=(t,e)=>{for(const n of e)if(n.key===t||n.children&&n.children.length>0&&d(t,n.children))return!0;return!1};return g(h.value).forEach(t=>{const{parent:e,depth:n}=c(t.key,a.options);if(e){const r=l.get(e.label)||0;l.set(e.label,r+1),s.set(e.label,n)}else{const r=l.get(t.label)||0;l.set(t.label,r+1),s.set(t.label,1)}}),Array.from(l.entries()).map(([t,e])=>s.get(t)===1?t:`${t}(${e}개)`).join(", ")});return(l,s)=>{const c=z,d=K;return T(),_("div",U,[V(c,{outlined:"",class:F(["w-full justify-between! bg-white! border-[#d1d5db]! text-gray-500! rounded-md text-sm!",a.buttonClass]),onClick:s[0]||(s[0]=o=>f.value=!0)},{default:k(()=>[O(D(u(A)||l.placeholder)+" ",1),s[2]||(s[2]=y("i",{class:"pi pi-chevron-down ml-2 flex-none text-sm!"},null,-1))]),_:1,__:[2]},8,["class"]),j(y("div",q,[V(d,{filter:!0,"filter-mode":"lenient","selection-keys":u(h),value:u(v),"expanded-keys":u(i),"selection-mode":"checkbox",class:"w-full relative z-10 px-0! py-0! shadow-md","filter-placeholder":l.placeholder,pt:{pcfilterinput:{root:"h-[38px]"},wrapper:"pb-2 text-sm! max-h-[50vh]",pcNodeCheckbox:{root:"w-4! h-4! mr-1",box:"h-full!"},nodeToggleButton:"w-4! h-4!"},"onUpdate:selectionKeys":s[1]||(s[1]=o=>N("update:modelValue",g(o))),onFilter:S},{nodeicon:k(o=>[o.node.icon?(T(),_("img",{key:0,src:o.node.icon,class:"w-5 h-5"},null,8,G)):P("",!0)]),default:k(o=>[O(D(o.node.label),1)]),_:1},8,["selection-keys","value","expanded-keys","filter-placeholder"]),y("div",{class:"fixed inset-0",onClick:E})],512),[[L,u(f)]])])}}});export{Q as _};
