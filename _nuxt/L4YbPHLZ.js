import{_ as te}from"./DUdz8K6f.js";import{u as oe,_ as re}from"./DE8tINAB.js";import{_ as se}from"./CDAhyYls.js";import{_ as ne}from"./vafz6C5P.js";import{T as le}from"./83vDd_yA.js";import ce from"./sw_mB974.js";import ae from"./Cqs6NOWa.js";import ie from"./BUh_Cmg7.js";import de from"./BaVsiyoq.js";import ue from"./D33oGfx-.js";import pe from"./jmBUdhTh.js";import{m as me,n as _e,r as z,p as L,x as he,g as fe,v as xe,j as ve,c as _,o as i,b as v,a as e,w as g,s as ye,k as t,F as B,L as j,z as $,A as k,l as ge,t as h,M as H,y as be,d as D,C as ke,P as N}from"./peAuiAyh.js";import{u as U}from"./BXP0eRD2.js";import{u as we}from"./DA1UzddV.js";import"./BZERu_QB.js";import"./CTP1-FHk.js";import"./BN4IjHZ8.js";import"./qAtJxd5W.js";import"./DraxB9Cm.js";import"./B2hgTxPe.js";import"./DaCcu9B6.js";import"./-qiQqHr2.js";import"./CLHmJszY.js";import"./De6F9JI4.js";import"./DbyCOtkE.js";import"./LTtCvQhq.js";import"./BpNJQ_7z.js";import"./CMIiD3Rt.js";import"./BXA2-95G.js";import"./CAKX58ps.js";import"./CIccNVYZ.js";import"./BqrJR1SS.js";import"./tiMItOhd.js";const Ce=me(()=>{const{data:b,...w}=_e({key:()=>["workHistory","errorList"],query:()=>U().workHistory.historyErrorListGet().then(o=>o.data)}),u=z({keyword:"",channels:[],errorCategory:"All"}),I=L(()=>{var a;const o=[{name:"All",code:"All"},{name:"옵션변경",code:"error-001"},{name:"판매중지",code:"error-002"},{name:"상품조회",code:"error-003"},{name:"채널정책",code:"error-999"}],d=((a=b.value)==null?void 0:a.error_group_code_data)||[];return o.map(n=>{var p;if(n.code==="All")return{...n,count:((p=b.value)==null?void 0:p.error_tot_count)||0};const m=d.find(y=>y.code===n.code);return{...n,count:(m==null?void 0:m.count)||0}})}),f=L(()=>{var d;let o=((d=b.value)==null?void 0:d.error_data_list)||[];if(u.value.errorCategory!=="All"&&(o=o.filter(a=>a.error_type_code===u.value.errorCategory)),u.value.keyword&&u.value.keyword.trim()){const a=u.value.keyword.trim();o=o.filter(n=>{const m=(n.channel_product_name||"").toLowerCase(),p=(n.channel_product_id||"").toLowerCase(),y=(n.error_type_name||"").toLowerCase();return m.includes(a)||p.includes(a)||y.includes(a)})}if(u.value.channels&&u.value.channels.length>0){const a=u.value.channels.map(n=>{const[m]=n.key.split("::");return m});o=o.filter(n=>a.includes(n.channel_id))}return o}),c=z([]),V=L({get:()=>f.value.length?c.value.length===f.value.length:!1,set:o=>{o?c.value=[...f.value]:c.value=[]}}),P=o=>c.value.some(d=>d.mid===o.mid),E=o=>{const d=c.value.findIndex(a=>a.mid===o.mid);d>-1?c.value.splice(d,1):c.value.push(o)};return he(f,()=>{c.value=[]}),{data:b,errorCategories:I,filteredErrorData:f,filter:u,isAllSelected:V,isItemSelected:P,selectedItems:c,toggleItemSelection:E,...w}}),Se={class:"portrait:h-dvh"},$e={class:"flex items-center gap-1"},Ie={ref:"$elExceptDiv",class:"px-4 js-exception-content"},Ve={class:"flex items-center mb-1 bg-white rounded-2xl"},Pe=["onClick"],Ee={class:"text-sm font-normal"},Ae={key:1,class:"text-sm font-normal"},Le={class:"flex items-center"},He={class:"flex items-center gap-2 text-sm"},De={key:0,class:"font-medium"},Te={class:"js-list"},ze={class:"flex w-full items-center mb-1"},Be={class:"w-4"},je={class:"p-checkbox p-component p-checkbox-sm p-inputfield-sm group has-checked:checked has-checked:text-white"},Ne=["checked","onChange"],Ue={class:"p-checkbox-box text-center peer-checked:border-[var(--p-checkbox-checked-border-color)]! peer-checked:bg-[var(--p-checkbox-checked-background)]! peer-checked:background group cursor-pointer"},Me={class:"w-14 text-center flex-none"},qe=["src"],Fe={class:"gap-1 w-[calc(100%-7rem)] ml-1"},Qe={class:"flex items-center justify-between mb-1"},Re={class:"font-medium leading-4"},Oe={class:"flex items-center"},Ge={class:"text-gray-400 text-xxs overflow-ellipsis whitespace-nowrap overflow-hidden"},We={type:"button",class:"text-xs w-8 h-8 right-0 top-0 text-[#3f7ddc]"},Je={class:"flex items-center pl-4"},Ke={class:"w-14 text-center flex-none text-xs text-gray-400"},Xe={class:"w-[calc(100%-4rem)] text-xs ml-1 flex items-center justify-between pr-3"},Ye={class:"text-red-400"},Ht=fe({__name:"error-list",setup(b){const w=U(),{contentHeight:u,updateAllHeights:I}=we(".js-exception-content");xe(()=>{I()});const{confirm:f,toast:c}=ve(),{getChannelIcon:V,channelOptionsWithAccount:P}=oe(),{data:E,error:o,isLoading:d,refetch:a,errorCategories:n,filteredErrorData:m,filter:p,isAllSelected:y,isItemSelected:A,selectedItems:x,toggleItemSelection:M}=Ce(),q=()=>{if(x.value.length===0){c.error("최소 1개이상의 품목을 선택바랍니다.");return}f({header:"오류 재전송",message:"채널로 오류 상품을 재전송하시겠습니까?",accept:()=>{console.log("확인");const{mutate:C}=N({mutation:()=>w.workHistory.historyErrorSyncPost({HistoryErrorSyncPostRequest:{type:"T",mid:x.value.map(r=>r.mid)}}),onSuccess:()=>{c.success(`총 ${x.value.length}건이 전송되었습니다.`)}});C()}})},F=()=>{if(x.value.length===0){c.error("최소 1개이상의 품목을 선택바랍니다.");return}f({header:"상품 동기화",message:"옵션을 동기화 하시겠습니까?",accept:()=>{console.log("확인");const{mutate:C}=N({mutation:()=>w.workHistory.historyErrorSyncPost({HistoryErrorSyncPostRequest:{type:"S",mid:x.value.map(r=>r.mid)}}),onSuccess:()=>{c.success(`총 ${x.value.length}건이 상품 동기화 진행합니다.`)}});C()}})};return(C,r)=>{const T=ye,Q=te,R=re,O=pe,G=ue,W=de,J=ie,K=se,X=ne,Y=ae,Z=ce,ee=le;return i(),_("article",Se,[v(Q,null,{right:g(()=>[e("div",$e,[v(T,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-white! border-white!",rounded:"",outlined:"",onClick:q},{default:g(()=>r[3]||(r[3]=[e("span",{class:"text-sm"},"오류 재전송",-1)])),_:1,__:[3]}),v(T,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-blue-100! border-blue-100!",rounded:"",onClick:F},{default:g(()=>r[4]||(r[4]=[e("span",{class:"text-sm"},"상품 동기화",-1)])),_:1,__:[4]})])]),_:1}),e("div",Ie,[v(R,{modelValue:t(p).channels,"onUpdate:modelValue":r[0]||(r[0]=l=>t(p).channels=l),options:t(P),placeholder:"판매채널 선택",class:"mb-1!","button-class":"rounded-full!"},null,8,["modelValue","options"]),v(W,{class:"mb-4 w-full"},{default:g(()=>[v(O,{modelValue:t(p).keyword,"onUpdate:modelValue":r[1]||(r[1]=l=>t(p).keyword=l),type:"text",class:"text-sm! w-full rounded-full! peer",placeholder:"상품명, 품목코드, 오류구분을 입력하세요"},null,8,["modelValue"]),v(G,{class:"pi pi-search peer-focus:text-primary!"})]),_:1}),e("div",Ve,[(i(!0),_(B,null,j(t(n),(l,s)=>(i(),_("button",{key:s,class:H(["py-2 w-full text-center text-gray-600",{"rounded-l-2xl w-56!":s===0,"rounded-r-2xl":s===t(n).length-1,"bg-gray-950 text-white":t(p).errorCategory===l.code}]),onClick:S=>t(p).errorCategory=l.code},[l.count?(i(),$(J,{key:0,value:l.count,size:"small",pt:{pcBadge:{root:"font-normal! bg-red-400! outline-1! rounded-full! -top-[5px]! right-[5px]!"}}},{default:g(()=>[e("strong",Ee,h(l.name),1)]),_:2},1032,["value"])):(i(),_("strong",Ae,h(l.name),1))],10,Pe))),128))])],512),e("div",{class:"px-4 pt-2 overflow-auto scrollbar-none transition-all duration-300",style:ke({height:t(u)})},[t(d)?(i(),$(K,{key:0,class:"h-full"})):k("",!0),t(o)?(i(),$(X,{key:1,retry:t(a)},null,8,["retry"])):k("",!0),e("div",Le,[e("div",He,[v(Y,{modelValue:t(y),"onUpdate:modelValue":r[2]||(r[2]=l=>ge(y)?y.value=l:null),size:"small","input-id":"all",name:"all",binary:!0},null,8,["modelValue"]),r[5]||(r[5]=e("label",{for:"all"},"전체선택",-1)),t(x).length>0?(i(),_("p",De,h(t(x).length)+"개 선택 ",1)):k("",!0)])]),!t(d)&&!t(o)&&t(E)?(i(),$(Z,{key:2,value:t(m),class:"w-full h-full",pt:{content:"bg-inherit! h-full"}},{list:g(l=>[e("div",Te,[(i(!0),_(B,null,j(l.items,(s,S)=>(i(),_("div",{key:S},[e("div",{class:H(["w-full py-2 text-sm border-gray-300 dark:border-gray-700",{"border-t":S!==0,"border-b":S===l.items.length-1}])},[e("div",ze,[e("div",Be,[e("div",je,[e("input",{type:"checkbox",class:"w-4 h-4 border peer appearance-none border-transparent rounded-[var(--p-checkbox-border-radius)] active:border-[var(--p-checkbox-hover-border-color)] absolute top-0 left-0 cursor-pointer",checked:t(A)(s),onChange:Ze=>t(M)(s)},null,40,Ne),e("div",Ue,[t(A)(s)?(i(),_("i",{key:0,class:H(["pi pi-check w-[var(--p-checkbox-icon-size)] text-xs! h-[var(--p-checkbox-icon-size)]",{"text-[var(--p-checkbox-icon-checked-color)]!":t(A)(s)}])},null,2)):k("",!0)])])]),e("div",Me,[e("img",{src:t(V)(s.channel_id),alt:"",class:"w-10 h-10 mx-auto"},null,8,qe)]),e("div",Fe,[e("div",Qe,[e("p",Re,h(s.channel_product_name),1)]),e("div",Oe,[e("div",Ge,[D(h(s.channel_name)+" ",1),r[6]||(r[6]=e("span",{class:"bg-gray-300 mx-1 w-px h-2 inline-block"},null,-1)),D(" "+h(s.channel_product_id),1)])])]),be((i(),_("button",We,r[7]||(r[7]=[e("i",{class:"pi pi-chevron-down text-gray-400! text-sm!"},null,-1)]))),[[ee,{value:s.msg,pt:{text:"text-sm!"}},void 0,{focus:!0,bottom:!0}]])]),e("div",Je,[e("div",Ke,h(s.worker_name),1),e("div",Xe,[e("span",Ye,h(s.error_type_name),1),D(" "+h(s.created_at),1)])])],2)]))),128))])]),_:1},8,["value"])):k("",!0)],4)])}}});export{Ht as default};
