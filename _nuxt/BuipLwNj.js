import N from"./BPCAsCHM.js";import{g as j,r as h,x as B,I as E,c as v,o as w,b as C,y as S,s as $,w as f,d as b,a as y,t as g,k as i,D as A,A as F,n as z}from"./B4bCfi2Z.js";const G={class:"relative"},P={class:"absolute top-0 w-full"},U=["src"],J=j({__name:"TreeMultiSelect",props:{options:{},modelValue:{},placeholder:{default:"판매채널 선택"}},emits:["update:modelValue"],setup(_,{emit:K}){const a=_,T=K,V=[{label:"전체",key:"all",children:a.options}],k=s=>{const e={},o=s.map(l=>l.key);return(l=>{l.forEach(n=>{if(n.children&&n.children.length>0){n.children.forEach(c=>{e[c.key]={checked:o.includes(c.key),partialChecked:!1}});const d=n.children.filter(c=>o.includes(c.key)).length;d===n.children.length?e[n.key]={checked:!0,partialChecked:!1}:d>0?e[n.key]={checked:!1,partialChecked:!0}:e[n.key]={checked:!1,partialChecked:!1}}else e[n.key]={checked:o.includes(n.key),partialChecked:!1}})})(a.options),e},r=h({all:!0}),u=h(k(a.modelValue));B(()=>a.modelValue,s=>{u.value=k(s)});const p=h(!1),M=()=>{p.value=!1},O=s=>{if(s.value!==""){for(let e of a.options)m(e);r.value={...r.value}}else r.value={all:!0}},m=s=>{if(s.children&&s.children.length){r.value[s.key]=!0;for(let e of s.children)m(e)}},x=s=>{const e=Object.entries(s).filter(([t,l])=>l.checked===!0).map(([t])=>t),o=[];return a.options.forEach(t=>{t.children&&t.children.length>0?o.push(...t.children):o.push(t)}),o.filter(t=>e.includes(t.key))},D=E(()=>{const s=new Map,e=new Map;return x(u.value).forEach(t=>{const l=a.options.find(n=>{var d;return(d=n.children)==null?void 0:d.some(c=>c.key===t.key)});if(l){const n=s.get(l.label)||0;s.set(l.label,n+1),e.set(l.label,2)}else{const n=s.get(t.label)||0;s.set(t.label,n+1),e.set(t.label,1)}}),Array.from(s.entries()).map(([t,l])=>e.get(t)===1?t:`${t}(${l}개)`).join(", ")});return(s,e)=>{const o=$,t=N;return w(),v("div",G,[C(o,{outlined:"",class:"w-full justify-between! bg-white! border-[#d1d5db]! text-gray-500! rounded-md! text-sm!",onClick:e[0]||(e[0]=l=>p.value=!0)},{default:f(()=>[b(g(i(D)||s.placeholder)+" ",1),e[2]||(e[2]=y("i",{class:"pi pi-chevron-down ml-2 flex-none text-sm!"},null,-1))]),_:1,__:[2]}),S(y("div",P,[C(t,{filter:!0,filterMode:"lenient",selectionKeys:i(u),"onUpdate:selectionKeys":e[1]||(e[1]=l=>T("update:modelValue",x(l))),value:V,expandedKeys:i(r),selectionMode:"checkbox",class:"w-full md:w-[30rem] relative z-10 px-0! py-0! shadow-md",onFilter:O,pt:{wrapper:"pb-2 text-sm!",pcNodeCheckbox:{root:"w-4! h-4! mr-1",box:"h-full!"},nodeToggleButton:"w-4! h-4!"}},{nodeicon:f(l=>[l.node.icon?(w(),v("img",{key:0,src:l.node.icon,class:"w-5 h-5"},null,8,U)):F("",!0)]),default:f(l=>[b(g(l.node.label),1)]),_:1},8,["selectionKeys","expandedKeys"]),y("div",{class:"fixed inset-0",onClick:M})],512),[[A,i(p)]])])}}});function Q(){return z}export{J as _,Q as u};
