import{_ as R}from"./B94M5IL9.js";import{u as W,a as J,_ as K}from"./CBpqNMSo.js";import{_ as X}from"./5WFsV7em.js";import{_ as Y}from"./DB8SILyZ.js";import{T as Z}from"./BVxEh6N9.js";import ee from"./B3hCu983.js";import te from"./CsbnmxMw.js";import oe from"./Dgpl1n2g.js";import se from"./B5avLe7O.js";import re from"./CpKQ8nij.js";import le from"./Bkgbl1mI.js";import{m as ne,n as ae,r as U,p as L,x as ie,g as ce,v as de,c as f,o as i,b as p,a as e,w as v,s as ue,k as t,F as B,L as E,z as C,A as V,l as me,t as _,M as z,y as pe,d as S,C as _e}from"./bTkifkby.js";import{u as fe}from"./CCHs8GSu.js";import"./Bpcq5skJ.js";import"./DSdChp7F.js";import"./CQwUNRvH.js";import"./DPIW6RoT.js";import"./AMap_Qn_.js";import"./DbPi1KHk.js";import"./CcQeZdM1.js";import"./BRURWb_k.js";import"./DAMcSKUi.js";import"./Dg1kG5fP.js";import"./DlM666ni.js";import"./DHTKu3CQ.js";import"./DTfDWkiO.js";import"./DIvExtia.js";import"./BiuVbIJu.js";import"./lw8q8feP.js";import"./DN31afvo.js";import"./BC3NqRPZ.js";import"./D5E5Cq0y.js";import"./Do8iWK-D.js";const he=ne(()=>{const{data:y,...I}=ae({key:()=>["workHistory","errorList"],query:()=>fe().workHistory.historyErrorListGet().then(o=>o.data)}),c=U({keyword:"",channel_list:[],errorCategory:"All"}),$=L(()=>{var s;const o=[{name:"All",code:"All"},{name:"옵션변경",code:"error-001"},{name:"판매중지",code:"error-002"},{name:"상품조회",code:"error-003"},{name:"채널정책",code:"error-999"}],u=((s=y.value)==null?void 0:s.error_group_code_data)||[];return o.map(r=>{var x;if(r.code==="All")return{...r,count:((x=y.value)==null?void 0:x.error_tot_count)||0};const m=u.find(g=>g.code===r.code);return{...r,count:(m==null?void 0:m.count)||0}})}),h=L(()=>{var u;let o=((u=y.value)==null?void 0:u.error_data_list)||[];if(c.value.errorCategory!=="All"&&(o=o.filter(s=>s.error_type_code===c.value.errorCategory)),c.value.keyword&&c.value.keyword.trim()){const s=c.value.keyword.trim();o=o.filter(r=>{const m=(r.channel_product_name||"").toLowerCase(),x=(r.channel_product_id||"").toLowerCase(),g=(r.error_type_name||"").toLowerCase();return m.includes(s)||x.includes(s)||g.includes(s)})}if(c.value.channel_list&&c.value.channel_list.length>0){const s=c.value.channel_list.map(r=>{const[m]=r.key.split("::");return m});o=o.filter(r=>s.includes(r.channel_id))}return o}),d=U([]),w=L({get:()=>h.value.length?d.value.length===h.value.length:!1,set:o=>{o?d.value=[...h.value]:d.value=[]}}),b=o=>d.value.some(u=>u.mid===o.mid),A=o=>{const u=d.value.findIndex(s=>s.mid===o.mid);u>-1?d.value.splice(u,1):d.value.push(o)};return ie(h,()=>{d.value=[]}),{data:y,errorCategories:$,filteredErrorData:h,filter:c,isAllSelected:w,isItemSelected:b,selectedItems:d,toggleItemSelection:A,...I}}),xe={class:"portrait:h-dvh"},ve={class:"flex items-center gap-1"},ye={ref:"$elExceptDiv",class:"px-4 js-exception-content"},ge={class:"flex items-center mb-1 bg-white rounded-2xl"},we=["onClick"],be={class:"text-sm font-normal"},ke={key:1,class:"text-sm font-normal"},Ce={class:"flex items-center"},Ve={class:"flex items-center gap-2 text-sm"},Ie={key:0,class:"font-medium"},$e={class:"js-list"},Ae={class:"flex w-full items-center mb-1"},Le={class:"w-4"},Se={class:"w-14 text-center flex-none"},De=["src"],Pe={class:"gap-1 w-[calc(100%-7rem)] ml-1"},Ue={class:"flex items-center justify-between mb-1"},Be={class:"font-medium leading-4"},Ee={class:"flex items-center"},ze={class:"text-gray-400 text-xxs overflow-ellipsis whitespace-nowrap overflow-hidden"},He={type:"button",class:"text-xs w-8 h-8 right-0 top-0 text-[#3f7ddc]"},Ne={class:"flex items-center pl-4"},Te={class:"w-14 text-center flex-none text-xs text-gray-400"},je={class:"w-[calc(100%-4rem)] text-xs ml-1 flex items-center justify-between pr-3"},Fe={class:"text-red-400"},kt=ce({__name:"error-list",setup(y){const{contentHeight:I,updateAllHeights:c}=W(".js-exception-content");de(()=>{c()});const{getChannelIcon:$,channelOptionsWithAccount:h}=J(),{data:d,error:w,isLoading:b,refetch:A,errorCategories:o,filteredErrorData:u,filter:s,isAllSelected:r,isItemSelected:m,selectedItems:x,toggleItemSelection:g}=he();return(Qe,l)=>{const D=ue,H=R,N=K,T=le,j=re,F=se,Q=oe,q=X,M=Y,P=te,O=ee,G=Z;return i(),f("article",xe,[p(H,null,{right:v(()=>[e("div",ve,[p(D,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-white! border-white!",rounded:"",outlined:""},{default:v(()=>l[3]||(l[3]=[e("span",{class:"text-sm"},"오류 재전송",-1)])),_:1,__:[3]}),p(D,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-blue-100! border-blue-100!",rounded:""},{default:v(()=>l[4]||(l[4]=[e("span",{class:"text-sm"},"상품 동기화",-1)])),_:1,__:[4]})])]),_:1}),e("div",ye,[p(N,{modelValue:t(s).channel_list,"onUpdate:modelValue":l[0]||(l[0]=n=>t(s).channel_list=n),options:t(h),placeholder:"판매채널 선택",class:"mb-1!","button-class":"rounded-full!"},null,8,["modelValue","options"]),p(F,{class:"mb-4 w-full"},{default:v(()=>[p(T,{modelValue:t(s).keyword,"onUpdate:modelValue":l[1]||(l[1]=n=>t(s).keyword=n),type:"text",class:"text-sm! w-full rounded-full! peer",placeholder:"상품명, 품목코드, 오류구분을 입력하세요"},null,8,["modelValue"]),p(j,{class:"pi pi-search peer-focus:text-primary!"})]),_:1}),e("div",ge,[(i(!0),f(B,null,E(t(o),(n,a)=>(i(),f("button",{key:a,class:z(["py-2 w-full text-center text-gray-600",{"rounded-l-2xl w-56!":a===0,"rounded-r-2xl":a===t(o).length-1,"bg-gray-950 text-white":t(s).errorCategory===n.code}]),onClick:k=>t(s).errorCategory=n.code},[n.count?(i(),C(Q,{key:0,value:n.count,size:"small",pt:{pcBadge:{root:"font-normal! bg-red-400! outline-1! rounded-full! -top-[5px]! right-[5px]!"}}},{default:v(()=>[e("strong",be,_(n.name),1)]),_:2},1032,["value"])):(i(),f("strong",ke,_(n.name),1))],10,we))),128))])],512),e("div",{class:"px-4 pt-2 overflow-auto scrollbar-none transition-all duration-300",style:_e({height:t(I)})},[t(b)?(i(),C(q,{key:0,class:"h-full"})):V("",!0),t(w)?(i(),C(M,{key:1,retry:t(A)},null,8,["retry"])):V("",!0),e("div",Ce,[e("div",Ve,[p(P,{modelValue:t(r),"onUpdate:modelValue":l[2]||(l[2]=n=>me(r)?r.value=n:null),size:"small","input-id":"all",name:"all",binary:!0},null,8,["modelValue"]),l[5]||(l[5]=e("label",{for:"all"},"전체선택",-1)),t(x).length>0?(i(),f("p",Ie,_(t(x).length)+"개 선택 ",1)):V("",!0)])]),!t(b)&&!t(w)&&t(d)?(i(),C(O,{key:2,value:t(u),class:"w-full h-full",pt:{content:"bg-inherit! h-full"}},{list:v(n=>[e("div",$e,[(i(!0),f(B,null,E(n.items,(a,k)=>(i(),f("div",{key:k},[e("div",{class:z(["w-full py-2 text-sm border-gray-300 dark:border-gray-700",{"border-t":k!==0,"border-b":k===n.items.length-1}])},[e("div",Ae,[e("div",Le,[p(P,{"model-value":t(m)(a),size:"small",binary:!0,"onUpdate:modelValue":qe=>t(g)(a)},null,8,["model-value","onUpdate:modelValue"])]),e("div",Se,[e("img",{src:t($)(a.channel_id),alt:"",class:"w-10 h-10 mx-auto"},null,8,De)]),e("div",Pe,[e("div",Ue,[e("p",Be,_(a.channel_product_name),1)]),e("div",Ee,[e("div",ze,[S(_(a.channel_name)+" ",1),l[6]||(l[6]=e("span",{class:"bg-gray-300 mx-1 w-px h-2 inline-block"},null,-1)),S(" "+_(a.channel_product_id),1)])])]),pe((i(),f("button",He,l[7]||(l[7]=[e("i",{class:"pi pi-chevron-down text-gray-400! text-sm!"},null,-1)]))),[[G,{value:a.msg,pt:{text:"text-sm!"}},void 0,{focus:!0,bottom:!0}]])]),e("div",Ne,[e("div",Te,_(a.worker_name),1),e("div",je,[e("span",Fe,_(a.error_type_name),1),S(" "+_(a.created_at),1)])])],2)]))),128))])]),_:1},8,["value"])):V("",!0)],4)])}}});export{kt as default};
