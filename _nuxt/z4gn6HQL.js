import{_ as X}from"./CbyzuZyH.js";import{_ as Y}from"./Cyfxe07w.js";import{_ as Z}from"./CVN3rI4Y.js";import{T as ee}from"./Dte8I4iE.js";import te from"./CMeYYduV.js";import oe from"./DN_4Wid1.js";import re from"./CfoPG_bg.js";import se from"./CuwmAYtz.js";import ne from"./BnYLuPlq.js";import le from"./B4Kzfla9.js";import{m as ce,n as ae,r as H,p as L,x as ie,g as de,v as ue,j as pe,c as f,o as a,b as y,a as e,w as g,s as me,k as t,F as _e,L as he,z as P,A as k,l as fe,t as p,M as z,y as xe,d as V,C as ye,P as j}from"./BMdYdyjj.js";import{u as B}from"./Cj2nymfZ.js";import{u as ve,a as ge}from"./BAr3Odsj.js";import"./7jNDRXfP.js";import"./BgA6nwsv.js";import"./DuE8BrvN.js";import"./B0RYkpeH.js";import"./Cfzj4L_I.js";const ke=ce(()=>{const{data:b,...C}=ae({key:()=>["workHistory","errorList"],query:()=>B().workHistory.historyErrorListGet().then(r=>r.data)}),m=H({keyword:"",errorCategory:"All"}),$=L(()=>{var l;const r=[{name:"All",code:"All"},{name:"옵션변경",code:"error-001"},{name:"판매중지",code:"error-002"},{name:"상품조회",code:"error-003"},{name:"채널정책",code:"error-999"}],i=((l=b.value)==null?void 0:l.error_group_code_data)||[];return r.map(c=>{var h;if(c.code==="All")return{...c,count:((h=b.value)==null?void 0:h.error_tot_count)||0};const d=i.find(v=>v.code===c.code);return{...c,count:(d==null?void 0:d.count)||0}})}),_=L(()=>{var i;let r=((i=b.value)==null?void 0:i.error_data_list)||[];if(m.value.errorCategory!=="All"&&(r=r.filter(l=>l.error_type_code===m.value.errorCategory)),m.value.keyword&&m.value.keyword.trim()){const l=m.value.keyword.trim();r=r.filter(c=>{const d=(c.channel_product_name||"").toLowerCase(),h=(c.channel_product_id||"").toLowerCase(),v=(c.error_type_name||"").toLowerCase(),u=(c.channel_name||"").toLowerCase();return d.includes(l)||h.includes(l)||v.includes(l)||u.includes(l)})}return r}),n=H([]),E=L({get:()=>_.value.length?n.value.length===_.value.length:!1,set:r=>{r?n.value=[..._.value]:n.value=[]}}),I=r=>n.value.some(i=>i._id===r._id),w=r=>{const i=n.value.findIndex(l=>l._id===r._id);i>-1?n.value.splice(i,1):n.value.push(r)};return ie(_,()=>{n.value=[]}),{data:b,errorCategories:$,filteredErrorData:_,filter:m,isAllSelected:E,isItemSelected:I,selectedItems:n,toggleItemSelection:w,...C}}),be={class:"portrait:h-dvh"},we={class:"flex items-center gap-1"},Ce={ref:"$elExceptDiv",class:"px-4 js-exception-content"},Se={class:"flex items-center mb-1 bg-white rounded-2xl"},Pe=["onClick"],$e={class:"text-sm font-normal"},Ee={key:1,class:"text-sm font-normal"},Ie={class:"flex items-center"},Le={class:"flex items-center gap-2 text-sm"},Ve={key:0,class:"font-medium"},Ae={class:"flex w-full items-center mb-1"},He={class:"w-4"},ze={class:"p-checkbox p-component p-checkbox-sm p-inputfield-sm group has-checked:checked has-checked:text-white"},je=["checked","onChange"],Be={class:"p-checkbox-box text-center peer-checked:border-[var(--p-checkbox-checked-border-color)]! peer-checked:bg-[var(--p-checkbox-checked-background)]! peer-checked:background group cursor-pointer"},De={key:0,class:"pi pi-check w-[var(--p-checkbox-icon-size)] text-xs! h-[var(--p-checkbox-icon-size)] text-[var(--p-checkbox-icon-checked-color)]!"},Ne={class:"w-14 text-center flex-none"},Te=["src"],Me={class:"gap-1 w-[calc(100%-7rem)] ml-1"},qe={class:"flex items-center justify-between mb-1"},Qe={class:"font-medium leading-4"},Re={class:"flex items-center"},Ue={class:"text-gray-400 text-xxs overflow-ellipsis whitespace-nowrap overflow-hidden"},Fe={type:"button",class:"text-xs w-8 h-8 right-0 top-0 text-[#3f7ddc]"},Oe={class:"w-full flex items-center pl-4"},Ge={class:"w-14 text-center flex-none text-xs text-gray-400"},Je={class:"w-[calc(100%-4rem)] text-xs ml-1 flex items-center justify-between pr-3"},Ke={class:"text-red-400"},We={key:3,class:"text-sm text-gray-400 h-full w-full flex items-center justify-center"},ht=de({__name:"error-list",setup(b){const C=B(),{contentHeight:m,updateAllHeights:$}=ve(".js-exception-content");ue(()=>{$()});const{confirm:_,toast:n}=pe(),{getChannelIcon:E}=ge(),{data:I,error:w,isLoading:r,refetch:i,errorCategories:l,filteredErrorData:c,filter:d,isAllSelected:h,isItemSelected:v,selectedItems:u,toggleItemSelection:D}=ke(),N=()=>{if(u.value.length===0){n.error("최소 1개이상의 품목을 선택바랍니다.");return}_({header:"오류 재전송",message:"채널로 오류 상품을 재전송하시겠습니까?",accept:()=>{console.log("확인");const{mutate:S}=j({mutation:()=>C.workHistory.historyErrorSyncPost({HistoryErrorSyncPostRequest:{type:"T",mid:u.value.map(s=>s.mid)}}),onSuccess:()=>{n.success(`총 ${u.value.length}건이 전송되었습니다.`)}});S()}})},T=()=>{if(u.value.length===0){n.error("최소 1개이상의 품목을 선택바랍니다.");return}_({header:"상품 동기화",message:"옵션을 동기화 하시겠습니까?",accept:()=>{console.log("확인");const{mutate:S}=j({mutation:()=>C.workHistory.historyErrorSyncPost({HistoryErrorSyncPostRequest:{type:"S",mid:u.value.map(s=>s.mid)}}),onSuccess:()=>{n.success(`총 ${u.value.length}건이 상품 동기화 진행합니다.`)}});S()}})};return(S,s)=>{const A=me,M=X,q=le,Q=ne,R=se,U=re,F=Y,O=Z,G=oe,J=te,K=ee;return a(),f("article",be,[y(M,null,{right:g(()=>[e("div",we,[y(A,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-white! border-white!",rounded:"",outlined:"",onClick:N},{default:g(()=>s[2]||(s[2]=[e("span",{class:"text-sm"},"오류 재전송",-1)])),_:1,__:[2]}),y(A,{type:"button",class:"flex items-center gap-2 text-blue-600! bg-blue-100! border-blue-100!",rounded:"",onClick:T},{default:g(()=>s[3]||(s[3]=[e("span",{class:"text-sm"},"상품 동기화",-1)])),_:1,__:[3]})])]),_:1}),e("div",Ce,[y(R,{class:"mb-4 w-full"},{default:g(()=>[y(q,{modelValue:t(d).keyword,"onUpdate:modelValue":s[0]||(s[0]=o=>t(d).keyword=o),type:"text",class:"text-sm! w-full rounded-full! peer",placeholder:"상품명, 품목코드, 오류구분을 입력하세요"},null,8,["modelValue"]),y(Q,{class:"pi pi-search peer-focus:text-primary!"})]),_:1}),e("div",Se,[(a(!0),f(_e,null,he(t(l),(o,x)=>(a(),f("button",{key:x,class:z(["py-2 w-full text-center text-gray-600",{"rounded-l-2xl w-56!":x===0,"rounded-r-2xl":x===t(l).length-1,"bg-gray-950 text-white":t(d).errorCategory===o.code}]),onClick:W=>t(d).errorCategory=o.code},[o.count?(a(),P(U,{key:0,value:o.count,size:"small",pt:{pcBadge:{root:"font-normal! bg-red-400! outline-1! rounded-full! -top-[5px]! right-[5px]!"}}},{default:g(()=>[e("strong",$e,p(o.name),1)]),_:2},1032,["value"])):(a(),f("strong",Ee,p(o.name),1))],10,Pe))),128))])],512),e("div",{class:"px-4 pt-2 transition-all duration-300",style:ye({height:t(m)})},[t(r)?(a(),P(F,{key:0,class:"h-full"})):k("",!0),t(w)?(a(),P(O,{key:1,retry:t(i)},null,8,["retry"])):k("",!0),e("div",Ie,[e("div",Le,[y(G,{modelValue:t(h),"onUpdate:modelValue":s[1]||(s[1]=o=>fe(h)?h.value=o:null),size:"small","input-id":"all",name:"all",binary:!0},null,8,["modelValue"]),s[4]||(s[4]=e("label",{for:"all"},"전체선택",-1)),t(u).length>0?(a(),f("p",Ve,p(t(u).length)+"개 선택 ",1)):k("",!0)])]),!t(r)&&!t(w)&&t(I)&&t(c).length>0?(a(),P(J,{key:2,items:t(c),"item-size":92,class:"w-full max-h-full scrollbar-none"},{item:g(({item:o,options:x})=>[e("div",{class:z(["w-full py-2 text-sm border-gray-300 dark:border-gray-700 flex flex-col items-center justify-center",{"border-t":x.index!==0,"border-b":x.index===x.length-1}]),style:{height:"92px"}},[e("div",Ae,[e("div",He,[e("div",ze,[e("input",{type:"checkbox",class:"w-4 h-4 border peer appearance-none border-transparent rounded-[var(--p-checkbox-border-radius)] active:border-[var(--p-checkbox-hover-border-color)] absolute top-0 left-0 cursor-pointer",checked:t(v)(o),onChange:W=>t(D)(o)},null,40,je),e("div",Be,[t(v)(o)?(a(),f("i",De)):k("",!0)])])]),e("div",Ne,[e("img",{src:t(E)(o.channel_id),alt:"",class:"w-10 h-10 mx-auto"},null,8,Te)]),e("div",Me,[e("div",qe,[e("p",Qe,p(o.channel_product_name),1)]),e("div",Re,[e("div",Ue,[V(p(o.channel_name)+" ",1),s[5]||(s[5]=e("span",{class:"bg-gray-300 mx-1 w-px h-2 inline-block"},null,-1)),V(" "+p(o.channel_product_id),1)])])]),xe((a(),f("button",Fe,s[6]||(s[6]=[e("i",{class:"pi pi-chevron-down text-gray-400! text-sm!"},null,-1)]))),[[K,{value:o.msg,pt:{text:"text-sm!"}},void 0,{focus:!0,bottom:!0}]])]),e("div",Oe,[e("div",Ge,p(o.worker_name),1),e("div",Je,[e("span",Ke,p(o.error_type_name),1),V(" "+p(o.created_at),1)])])],2)]),_:1},8,["items"])):k("",!0),!t(r)&&!t(w)&&t(c).length<1?(a(),f("p",We," 데이터가 없습니다. ")):k("",!0)],4)])}}});export{ht as default};
