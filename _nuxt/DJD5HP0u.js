import A from"./C2_Hh34c.js";import{g as K,p as b,r as k,x as C,c as _,o as V,b as T,y as $,s as F,w as m,d as O,a as y,t as D,k as u,B as L,A as P,V as z}from"./U1tzv9eA.js";const U={class:"relative"},q={class:"absolute top-0 w-full"},G=["src"],Q=K({__name:"TreeMultiSelect",props:{options:{},modelValue:{},placeholder:{default:"판매채널 선택"}},emits:["update:modelValue"],setup(B,{emit:M}){const c=B,N=M,v=b(()=>[{label:"전체",key:"all",children:c.options}]),f=n=>{const l={},a=n.map(t=>t.key),d=t=>{t.forEach(e=>{if(e.children&&e.children.length>0){d(e.children);const s=o(e.children),r=s.filter(w=>a.includes(w.key)).length;r===s.length&&s.length>0?l[e.key]={checked:!0,partialChecked:!1}:r>0?l[e.key]={checked:!1,partialChecked:!0}:l[e.key]={checked:!1,partialChecked:!1}}else l[e.key]={checked:a.includes(e.key),partialChecked:!1}})},o=t=>{const e=[];return t.forEach(s=>{s.children&&s.children.length>0?e.push(...o(s.children)):e.push(s)}),e};return d(v.value),l},i=k({all:!0}),h=k(f(c.modelValue));C(()=>c.modelValue,n=>{h.value=f(n)}),C(()=>c.options,n=>{h.value=f(c.modelValue)});const p=k(!1),j=()=>{p.value=!1},E=n=>{if(n.value!==""){for(const l of c.options)x(l);i.value={...i.value}}else i.value={all:!0}},x=n=>{if(n.children&&n.children.length){i.value[n.key]=!0;for(const l of n.children)x(l)}},g=n=>{const l=Object.entries(n).filter(([o,t])=>t.checked===!0).map(([o])=>o),a=o=>{const t=[];return o.forEach(e=>{e.children&&e.children.length>0?t.push(...a(e.children)):t.push(e)}),t};return a(c.options).filter(o=>l.includes(o.key))},S=b(()=>{const n=new Map,l=new Map,a=(t,e,s=1)=>{for(const r of e){if(r.key===t)return{parent:null,depth:s};if(r.children&&r.children.length>0&&d(t,r.children))return{parent:r,depth:s+1}}return{parent:null,depth:1}},d=(t,e)=>{for(const s of e)if(s.key===t||s.children&&s.children.length>0&&d(t,s.children))return!0;return!1};return g(h.value).forEach(t=>{const{parent:e,depth:s}=a(t.key,c.options);if(e){const r=n.get(e.label)||0;n.set(e.label,r+1),l.set(e.label,s)}else{const r=n.get(t.label)||0;n.set(t.label,r+1),l.set(t.label,1)}}),Array.from(n.entries()).map(([t,e])=>l.get(t)===1?t:`${t}(${e}개)`).join(", ")});return(n,l)=>{const a=F,d=A;return V(),_("div",U,[T(a,{outlined:"",class:"w-full justify-between! bg-white! border-[#d1d5db]! text-gray-500! rounded-md! text-sm!",onClick:l[0]||(l[0]=o=>p.value=!0)},{default:m(()=>[O(D(u(S)||n.placeholder)+" ",1),l[2]||(l[2]=y("i",{class:"pi pi-chevron-down ml-2 flex-none text-sm!"},null,-1))]),_:1,__:[2]}),$(y("div",q,[T(d,{filter:!0,"filter-mode":"lenient","selection-keys":u(h),value:u(v),"expanded-keys":u(i),"selection-mode":"checkbox",class:"w-full relative z-10 px-0! py-0! shadow-md",pt:{wrapper:"pb-2 text-sm!",pcNodeCheckbox:{root:"w-4! h-4! mr-1",box:"h-full!"},nodeToggleButton:"w-4! h-4!"},"onUpdate:selectionKeys":l[1]||(l[1]=o=>N("update:modelValue",g(o))),onFilter:E},{nodeicon:m(o=>[o.node.icon?(V(),_("img",{key:0,src:o.node.icon,class:"w-5 h-5"},null,8,G)):P("",!0)]),default:m(o=>[O(D(o.node.label),1)]),_:1},8,["selection-keys","value","expanded-keys"]),y("div",{class:"fixed inset-0",onClick:j})],512),[[L,u(p)]])])}}});function R(){return z}export{Q as _,R as u};
