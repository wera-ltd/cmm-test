import{_ as Z}from"./DXYu5HIg.js";import G from"./C3iRQSRt.js";import ee from"./CIoJWCeQ.js";import{g as L,j as N,r as M,z as A,o as p,w as f,a as t,c as _,F as P,L as T,k as o,b as u,s as U,d as v,t as g,v as W,p as te,l as se,R as le,S as E,A as j,C as oe,M as F,N as q,P as ne}from"./R2OK_SMX.js";import ae from"./DZa6n-tA.js";import ie from"./BMnCUFoy.js";import{_ as K}from"./D1_TIH6A.js";import{u as O}from"./CQ5xeofe.js";import re from"./DjhZ1UKM.js";import{a as de,u as ue}from"./CeL9mjwo.js";import{u as ce}from"./Dpgfc6r2.js";import{u as me}from"./ANdCS1qd.js";import"./Bph0P4T8.js";import"./OP5eTPTY.js";import"./Cjt24DIL.js";import"./Drr4S2jj.js";import"./n5LFdeOX.js";import"./o4Rs72N-.js";import"./D-CY1jhL.js";import"./56yZKbqr.js";import"./BxojO_6-.js";import"./B1AUoqIA.js";const pe={class:"border-t border-[var(--space-border)] px-4 py-4 flex-1 overflow-y-auto scrollbar-none"},_e={class:"space-y-3"},fe={class:"mt-4"},ye={class:"text-xs text-gray-500 mt-2"},ve={class:"h-14 shrink-0 w-full flex items-center border-t-gray-100 border-t justify-center px-3 py-2 gap-2"},he=L({__name:"TimeBulkSetting",emits:["closed"],setup(I,{emit:z}){const b=z,{scheduleData:x}=O(),{toast:D}=N(),s=M([]),r=d=>{if(!d||d.length!==4)return null;const a=parseInt(d.substring(0,2)),C=parseInt(d.substring(2,4)),i=new Date;return i.setHours(a,C,0,0),i},w=(d,a)=>{s.value[d]=a.replace(":","")},B=()=>{var d;s.value.length<(((d=x.value)==null?void 0:d.round)||0)&&s.value.push("0000")},h=d=>{s.value.splice(d,1)},n=()=>{if(s.value.length===0){D.error("최소 하나의 시간을 설정해야 합니다.");return}x.value.days_list.forEach(d=>{d.time=[...s.value],d.is_day=!0}),b("closed")};return(d,a)=>{const C=G,i=U,l=K;return p(),A(l,{"content-class":"bg-white w-80 h-[50dvh] flex flex-col","header-class":"shrink-0 border-b border-zinc-200",onClosed:a[1]||(a[1]=e=>b("closed"))},{title:f(()=>a[2]||(a[2]=[t("h1",{class:"font-semibold"}," 시간일괄설정 ",-1)])),default:f(()=>{var e,c;return[t("div",pe,[a[4]||(a[4]=t("div",{class:"text-sm text-gray-600 mb-4"}," 설정된 시간이 모든 요일에 적용됩니다. ",-1)),t("div",_e,[(p(!0),_(P,null,T(o(s),(y,k)=>(p(),_("div",{key:k,class:"flex items-center border-b border-gray-200 pb-3"},[u(C,{"model-value":r(y),"step-minute":10,"time-only":"",placeholder:"시/분",class:"w-full",onBlur:$=>w(k,$.value)},null,8,["model-value","onBlur"]),u(i,{icon:"pi pi-times",severity:"secondary",rounded:"",size:"small",variant:"text","aria-label":"Cancel",class:"ml-1",onClick:$=>h(k)},null,8,["onClick"])]))),128))]),t("div",fe,[u(i,{disabled:o(s).length>=(((e=o(x))==null?void 0:e.round)||0),rounded:"",size:"small",outlined:"",severity:"secondary",onClick:B},{default:f(()=>a[3]||(a[3]=[t("i",{class:"pi pi-plus text-sm!"},null,-1),v(" 시간추가 ")])),_:1,__:[3]},8,["disabled"]),t("div",ye," 최대 "+g(((c=o(x))==null?void 0:c.round)||0)+"개까지 추가 가능 ",1)])]),t("div",ve,[u(i,{size:"small",class:"w-full h-full text-sm!",severity:"secondary",onClick:a[0]||(a[0]=y=>b("closed"))},{default:f(()=>a[5]||(a[5]=[v(" 닫기 ")])),_:1,__:[5]}),u(i,{size:"small",class:"w-full h-full text-sm!",onClick:n},{default:f(()=>a[6]||(a[6]=[v(" 설정 ")])),_:1,__:[6]})])]}),_:1})}}}),ge={class:"border-t border-[var(--space-border)] px-4 py-4 flex-1 overflow-y-auto scrollbar-none"},be={class:"flex items-center gap-2 text-sm mb-3"},xe={for:"all"},ke={class:"text-primary font-normal"},we={class:"gap-2 flex flex-col"},Ce=["onClick"],$e={class:"flex items-center gap-2"},Se=["src"],ze={class:"font-medium block"},De={class:"text-xs text-gray-500"},Be={class:"h-14 shrink-0 w-full flex items-center border-t-gray-100 border-t justify-center px-3 py-2 gap-2"},Pe=L({__name:"ChannelListSetting",emits:["closed"],setup(I,{emit:z}){const b=z,{toast:x}=N(),{getChannelIcon:D}=de(),{scheduleData:s}=O(),r=M();W(()=>{s.value&&(r.value=JSON.parse(JSON.stringify(s.value)))});const w=te({get:()=>!r.value.channel_list||r.value.channel_list.length===0?!1:r.value.channel_list.every(h=>h.is_channel),set:h=>{r.value.channel_list.forEach(n=>{n.is_channel=h})}}),B=()=>{if(!r.value.channel_list.filter(h=>h.is_channel).length){x.error("쇼핑몰 설정은 필수입니다.최소 1개이상 추가 설정 바랍니다.");return}s.value=JSON.parse(JSON.stringify(r.value)),b("closed")};return(h,n)=>{const d=re,a=U,C=K;return p(),A(C,{"content-class":"bg-white w-full h-dvh flex flex-col","header-class":"shrink-0 border-b border-zinc-200",onClosed:n[3]||(n[3]=i=>b("closed"))},{title:f(()=>n[4]||(n[4]=[t("h1",{class:"font-semibold"}," 판매채널 설정 ",-1)])),default:f(()=>[t("div",ge,[t("div",be,[u(d,{modelValue:o(w),"onUpdate:modelValue":n[0]||(n[0]=i=>se(w)?w.value=i:null),size:"small","input-id":"all",name:"all",binary:!0},null,8,["modelValue"]),t("label",xe,[n[5]||(n[5]=v("총 ")),t("b",ke,g(o(r).channel_list.length),1),n[6]||(n[6]=v("개 전체선택 "))])]),t("ul",we,[(p(!0),_(P,null,T(o(r).channel_list,(i,l)=>(p(),_("li",{key:i.account_id,class:"border rounded-md border-gray-200 p-4 flex justify-between items-center cursor-pointer",onClick:e=>i.is_channel=!i.is_channel},[t("div",$e,[t("span",null,g(l+1)+".",1),t("img",{src:o(D)(i.channel_id),alt:"",class:"w-10 h-10"},null,8,Se),t("div",null,[t("strong",ze,g(i.channel_name),1),t("p",De,g(i.account_id),1)])]),u(d,{modelValue:i.is_channel,"onUpdate:modelValue":e=>i.is_channel=e,size:"small","input-id":`channel-${i.account_id}`,binary:!0,onClick:n[1]||(n[1]=le(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue","input-id"])],8,Ce))),128))])]),t("div",Be,[u(a,{size:"small",class:"w-full h-full text-sm!",severity:"secondary",onClick:n[2]||(n[2]=i=>b("closed"))},{default:f(()=>n[7]||(n[7]=[v(" 닫기 ")])),_:1,__:[7]}),u(a,{size:"small",class:"w-full h-full text-sm!",onClick:B},{default:f(()=>n[8]||(n[8]=[v(" 확인 ")])),_:1,__:[8]})])]),_:1})}}}),Te={class:"bg-white p-4 border-b-8 border-gray-200"},Ve={class:"gap-0.5 flex flex-col text-sm mb-4 text-gray-500"},je={class:"text-primary font-semibold"},Le={class:"flex flex-col gap-2"},Ne={class:"flex items-center justify-between"},Me={class:"flex items-center justify-between"},Ae={class:"bg-white"},Ue={class:"flex flex-col gap-2 relative"},Oe={key:0,class:"absolute w-full h-full bg-white/50 z-10 flex items-center justify-center text-sm font-medium"},Ie={class:"flex items-center justify-between mb-4"},Qe={class:"flex flex-wrap gap-1"},He=["onClick"],Je={class:"font-medium uppercase text-gray-700"},Re={key:1,class:"font-medium uppercase text-gray-700"},Ee={key:2,class:"w-2 h-2 rounded-full block bg-purple-500 mx-auto my-2"},Fe={class:"text-sm text-gray-400"},qe={class:"block py-4"},Ge={class:"flex items-center justify-between mb-2"},We={class:"flex items-center gap-2"},Ke={class:"font-medium uppercase"},Xe={class:"flex flex-wrap gap-y-2"},bt=L({__name:"schedule",setup(I){const z=ce(),{toast:b,confirm:x}=N(),{contentHeight:D}=ue(),{scheduleData:s}=O(),r=M(0),w=async l=>{var c;const e=(c=s.value)==null?void 0:c.days_list[r.value];e&&(!l&&e.time.length>0?x({message:"해당 요일의 모든 시간 슬롯이 삭제됩니다. 계속하시겠습니까?",accept:()=>{e.time=[],e.is_day=!1},reject:()=>{e.is_day=!0}}):(e.is_day=l,n()))},B=l=>{if(!l||l.length!==4)return null;const e=parseInt(l.substring(0,2)),c=parseInt(l.substring(2,4)),y=new Date;return y.setHours(e,c,0,0),y},h=(l,e,c)=>{var y,k;(k=(y=s.value)==null?void 0:y.days_list[l])!=null&&k.time&&(s.value.days_list[l].time[e]=c.replace(":",""))},n=()=>{var e,c;const l=(e=s.value)==null?void 0:e.days_list[r.value];l&&l.time.length<(((c=s.value)==null?void 0:c.round)||0)&&(l.time.push("0000"),l.time.length===1&&(l.is_day=!0))},d=l=>{var c;const e=(c=s.value)==null?void 0:c.days_list[r.value];e&&e.time.length>0&&(e.time.splice(l,1),e.time.length===0&&(e.is_day=!1))},a=()=>{const{open:l}=q({component:he});l()},C=()=>{const{open:l}=q({component:Pe});l()},i=()=>{const{mutate:l}=ne({mutation:()=>me().customer.customerSettingUpdatePatch({CustomerSettingUpdatePatchRequest:{stock_setup_data:{},schedule_data:{...s.value}}}),onSuccess:()=>{E().invalidateQueries({key:["customer","setting"]}),b.success("저장되었습니다.")}});l()};return W(()=>{E().invalidateQueries({key:["customer","setting"]})}),(l,e)=>{var Q,H,J,R;const c=Z,y=ie,k=ae,$=U,X=ee,Y=G;return p(),_(P,null,[u(c,{class:""}),o(s)?(p(),_("div",{key:0,class:"overflow-auto scrollbar-none",style:oe(`height: ${o(D)}`)},[t("div",Te,[t("div",Ve,[t("p",null,[e[1]||(e[1]=v(" • 요일별 최대 추가 가능 슬롯은 ")),t("strong",je,g((Q=o(s))==null?void 0:Q.round)+"개",1),e[2]||(e[2]=v("까지 가능합니다. "))]),e[3]||(e[3]=t("p",null," • 스케줄 설정시 쇼핑몰 설정도 같이 선택하여주시기 바랍니다. ",-1))]),t("div",Le,[t("div",Ne,[e[4]||(e[4]=t("b",{class:"font-medium"},"스케줄 사용여부",-1)),u(y,{modelValue:o(s).is_schedule,"onUpdate:modelValue":e[0]||(e[0]=m=>o(s).is_schedule=m)},null,8,["modelValue"])]),t("div",Me,[e[6]||(e[6]=t("b",{class:"font-medium"},"쇼핑몰 설정",-1)),t("button",{class:"inline-flex items-center gap-4 text-gray-400 cursor-pointer",onClick:C},[u(k,{severity:"contrast",value:`${(J=(H=o(s))==null?void 0:H.channel_list)==null?void 0:J.filter(m=>m.is_channel).length}개 채널`,class:"font-normal! text-sm! rounded-full!"},null,8,["value"]),e[5]||(e[5]=t("i",{class:"pi pi-chevron-right"},null,-1))])])])]),t("div",Ae,[t("div",Ue,[o(s).is_schedule?j("",!0):(p(),_("div",Oe," 스케줄을 사용할 수 없습니다. ")),t("article",{class:F([{"opacity-10":!o(s).is_schedule},"p-4"])},[t("header",Ie,[e[8]||(e[8]=t("h3",{class:"font-medium text-gray-800"}," Weekly schedule ",-1)),u($,{rounded:"",size:"small",outlined:"",onClick:a},{default:f(()=>e[7]||(e[7]=[v(" 시간일괄설정 ")])),_:1,__:[7]})]),t("div",Qe,[(p(!0),_(P,null,T((R=o(s))==null?void 0:R.days_list,(m,S)=>(p(),_("button",{key:S,class:F(["rounded-lg cursor-pointer border w-[calc(25%-3px)] text-center px-4 py-6 relative border-gray-200 shadow-xs",[{"bg-gray-100":!m.is_day},{"shadow-[0_0_10px]! shadow-purple-400/60!":o(s).days_list[o(r)].day===m.day}]]),onClick:V=>r.value=S},[o(z)().format("ddd").toLowerCase()==m.day?(p(),A(X,{key:0,value:"오늘",size:"small",pt:{pcBadge:{root:"font-normal! bg-red-400! outline-1! -top-[55%]!  right-[5%]!"}}},{default:f(()=>[t("strong",Je,g(m.day),1)]),_:2},1024)):(p(),_("strong",Re,g(m.day),1)),m.time&&m.time.length>0?(p(),_("i",Ee)):j("",!0),t("p",Fe,g(m.time.length<1?"-":m.time.length+" slots"),1)],10,He))),128))]),t("div",qe,[t("div",Ge,[t("div",We,[t("strong",Ke,g(o(s).days_list[o(r)].day),1),u(y,{"model-value":o(s).days_list[o(r)].is_day,class:"relative w-10! h-5!",pt:{handle:"w-3! h-3! data-[p=checked]:start-[24px]! top-[60%]!",slider:"data-[p=checked]:bg-violet-500!"},"onUpdate:modelValue":w},null,8,["model-value"])])]),t("div",Xe,[(p(!0),_(P,null,T(o(s).days_list[o(r)].time,(m,S)=>(p(),_("div",{key:m+S},[u(Y,{"model-value":B(m),"step-minute":10,"time-only":"",placeholder:"시/분",class:"w-32",onBlur:V=>h(o(r),S,V.value)},null,8,["model-value","onBlur"]),u($,{icon:"pi pi-times",severity:"secondary",rounded:"",size:"small",variant:"text","aria-label":"Cancel",class:"ml-1",onClick:V=>d(S)},null,8,["onClick"])]))),128)),u($,{rounded:"",size:"small",outlined:"",severity:"secondary",onClick:n},{default:f(()=>e[9]||(e[9]=[t("i",{class:"pi pi-plus text-sm!"},null,-1),v(" 시간추가 ")])),_:1,__:[9]})])])],2)]),u($,{type:"button",class:"flex w-full items-center gap-2 text-blue-600! bg-blue-100! border-blue-100!",rounded:"",onClick:i},{default:f(()=>e[10]||(e[10]=[t("span",{class:"text-sm"},"저장",-1)])),_:1,__:[10]})])],4)):j("",!0)],64)}}});export{bt as default};
